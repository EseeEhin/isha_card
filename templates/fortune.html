<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†è¿åŠ¿ - ç»ˆæç‰ˆ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .container { max-width: 1200px; }
        .card-header { font-weight: bold; }
    </style>
</head>
<body>
    <div class="container mt-5 mb-5">
        <h1 class="text-center mb-4">ç®¡ç†è¿åŠ¿ - ç»ˆææ¨¡å—åŒ–ç‰ˆ</h1>
        
        <!-- ç®¡ç†è¿æ¥è¯ -->
        <div class="card mb-4">
            <div class="card-header bg-info text-white">æ‹¼æ¥æ–‡æœ¬ç®¡ç†</div>
            <div class="card-body">
                <form action="{{ url_for('fortune_web') }}" method="post">
                    <input type="hidden" name="form_type" value="connectors">
                    <div class="mb-3">
                        <label class="form-label">å¼€åœºç™½</label>
                        <input type="text" class="form-control" name="intro" value="{{ fortune_data.connectors.intro }}">
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <label class="form-label">å‰è¿ç»“å°¾</label>
                            <input type="text" class="form-control" name="outro_good" value="{{ fortune_data.connectors.outro_good }}">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">ä¸­æ€§ç»“å°¾</label>
                            <input type="text" class="form-control" name="outro_neutral" value="{{ fortune_data.connectors.outro_neutral }}">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">å„è¿ç»“å°¾</label>
                            <input type="text" class="form-control" name="outro_bad" value="{{ fortune_data.connectors.outro_bad }}">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-info mt-3">ä¿å­˜æ‹¼æ¥æ–‡æœ¬</button>
                </form>
            </div>
        </div>

        <!-- ç®¡ç†æ ‡ç­¾æ±  -->
        {% for pool_name, pool_data in [('good', fortune_data.tag_pools.good), ('neutral', fortune_data.tag_pools.neutral), ('bad', fortune_data.tag_pools.bad)] %}
        <div class="card mb-4">
            <div class="card-header 
                {% if pool_name == 'good' %}bg-success{% elif pool_name == 'neutral' %}bg-secondary{% else %}bg-danger{% endif %} text-white">
                {{ {'good': 'å‰è¿', 'neutral': 'ä¸­æ€§', 'bad': 'å„è¿'}[pool_name] }}æ ‡ç­¾æ± ç®¡ç†
            </div>
            <div class="card-body">
                <form action="{{ url_for('fortune_web') }}" method="post">
                    <input type="hidden" name="form_type" value="edit_pool">
                    <input type="hidden" name="pool_name" value="{{ pool_name }}">
                    <table class="table table-sm">
                        <thead><tr><th>æ ‡ç­¾</th><th>æ–‡æœ¬ç‰‡æ®µ</th><th>æ“ä½œ</th></tr></thead>
                        <tbody>
                        {% for item in pool_data %}
                            <tr>
                                <td><input type="text" class="form-control form-control-sm" name="tag_{{ item.id }}" value="{{ item.tag }}"></td>
                                <td><input type="text" class="form-control form-control-sm" name="text_{{ item.id }}" value="{{ item.text }}"></td>
                                <td><button type="submit" name="delete_tag" value="{{ item.id }}" class="btn btn-outline-danger btn-sm">åˆ é™¤</button></td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <button type="submit" class="btn btn-sm {% if pool_name == 'good' %}btn-success{% elif pool_name == 'neutral' %}btn-secondary{% else %}btn-danger{% endif %}">ä¿å­˜æ± å†…å˜æ›´</button>
                </form>
                <hr>
                <form action="{{ url_for('fortune_web') }}" method="post" class="mt-3">
                    <input type="hidden" name="form_type" value="add_to_pool">
                    <input type="hidden" name="pool_name" value="{{ pool_name }}">
                    <div class="row g-2">
                        <div class="col-auto"><span class="form-text">æ·»åŠ æ–°æ¡ç›®:</span></div>
                        <div class="col"><input type="text" class="form-control form-control-sm" name="new_tag" placeholder="æ–°æ ‡ç­¾" required></div>
                        <div class="col"><input type="text" class="form-control form-control-sm" name="new_text" placeholder="æ–°æ–‡æœ¬ç‰‡æ®µ" required></div>
                        <div class="col-auto"><button type="submit" class="btn btn-sm btn-outline-primary">æ·»åŠ </button></div>
                    </div>
                </form>
            </div>
        </div>
        {% endfor %}

        <!-- ç®¡ç†è¿åŠ¿ç­‰çº§ -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">è¿åŠ¿ç­‰çº§ç®¡ç†</div>
            <div class="card-body">
                <form action="{{ url_for('fortune_web') }}" method="post">
                    <input type="hidden" name="form_type" value="levels">
                    <table class="table table-sm">
                        <thead><tr><th>ID</th><th>ç­‰çº§åç§°</th><th>æ˜Ÿæ˜Ÿæ•°</th><th>æ˜Ÿæ˜Ÿå½¢çŠ¶</th><th>å›¾ç‰‡é“¾æ¥</th></tr></thead>
                        <tbody>
                        {% for level in fortune_data.levels %}
                            <tr>
                                <td>{{ level.id }}</td>
                                <td><input type="text" class="form-control form-control-sm" name="level_name_{{ level.id }}" value="{{ level.level_name }}"></td>
                                <td><input type="number" class="form-control form-control-sm" name="stars_{{ level.id }}" value="{{ level.stars }}" min="1" max="7"></td>
                                <td>
                                    <select class="form-select form-select-sm" name="star_shape_{{ level.id }}">
                                        <option value="star" {% if level.star_shape == 'star' %}selected{% endif %}>æ˜Ÿæ˜Ÿ âœ¨</option>
                                        <option value="heart" {% if level.star_shape == 'heart' %}selected{% endif %}>çˆ±å¿ƒ â¤ï¸</option>
                                        <option value="coin" {% if level.star_shape == 'coin' %}selected{% endif %}>é‡‘å¸ ğŸ’°</option>
                                        <option value="thorn" {% if level.star_shape == 'thorn' %}selected{% endif %}>è†æ£˜ ğŸ¥€</option>
                                        <option value="skull" {% if level.star_shape == 'skull' %}selected{% endif %}>éª·é«… ğŸ’€</option>
                                    </select>
                                </td>
                                <td><input type="text" class="form-control form-control-sm" name="image_{{ level.id }}" value="{{ level.image or '' }}" placeholder="è¾“å…¥å›¾ç‰‡URL"></td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <button type="submit" class="btn btn-primary btn-sm">ä¿å­˜ç­‰çº§å˜æ›´</button>
                </form>
            </div>
        </div>

        <div class="text-center mt-4">
            <a href="/" class="btn btn-secondary">è¿”å›ä¸»é¡µ</a>
        </div>
    </div>
</body>
</html>
